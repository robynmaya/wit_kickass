#!/bin/bash

# Full-Stack Practice Workspace Setup Script
# Ensures Docker, dependencies, and databases are properly configured

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m'

print_header() {
    echo -e "${BLUE}============================================${NC}"
    echo -e "${BLUE}🚀 Full-Stack Practice Workspace Setup${NC}"
    echo -e "${BLUE}============================================${NC}"
    echo
}

print_success() {
    echo -e "${GREEN}✅ $1${NC}"
}

print_error() {
    echo -e "${RED}❌ $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}⚠️  $1${NC}"
}

print_info() {
    echo -e "${BLUE}ℹ️  $1${NC}"
}

# Function to check if command exists
command_exists() {
    command -v "$1" >/dev/null 2>&1
}

# Check prerequisites
echo "📋 Checking prerequisites..."

if ! command_exists node; then
    echo "❌ Node.js not found. Please install Node.js first."
    exit 1
fi

if ! command_exists npm; then
    echo "❌ npm not found. Please install npm first."
    exit 1
fi

if ! command_exists python3; then
    echo "❌ Python 3 not found. Please install Python 3 first."
    exit 1
fi

echo "✅ All prerequisites found!"

# Setup Express app
echo ""
echo "🟢 Setting up React + Express app..."
cd react-express-app/frontend && npm install
cd ../backend && npm install
cd ../..

# Setup Python app frontend
echo ""
echo "🐍 Setting up React + Python app frontend..."
cd react-python-app/frontend && npm install
cd ../..

# Setup Rails app frontend  
echo ""
echo "💎 Setting up React + Rails app frontend..."
cd react-rails-app/frontend && npm install
cd ../..

echo ""
echo "🎉 Setup complete!"
echo ""
echo "📖 Next steps:"
echo "1. Choose an app to work on (react-express-app, react-python-app, or react-rails-app)"
echo "2. Read the app's README.md for specific setup instructions"
echo "3. Use VS Code tasks to start frontend/backend servers"
echo ""
echo "🛠 Quick commands:"
echo "- Express app: cd react-express-app && npm run dev (in both frontend/ and backend/)"
echo "- Python app: cd react-python-app/backend && python app.py + cd ../frontend && npm run dev"
echo "- Rails app: Follow the README for Rails-specific setup"
echo ""
echo "Happy coding! 🎯"
